
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Estimating periodic signals &#8212; cogent3 2023.12.12 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=da3cec82" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="../../_static/documentation_options.js?v=d202a915"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'doc/examples/period_estimation';</script>
    <link rel="icon" href="../../_static/c3-square.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The simplest script" href="simple.html" />
    <link rel="prev" title="Manipulation of Tree Node Objects" href="manipulating_tree_nodes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/c3-logo.png" class="logo__image only-light" alt="cogent3 2023.12.12 documentation - Home"/>
    <script>document.write(`<img src="../../_static/c3-logo.png" class="logo__image only-dark" alt="cogent3 2023.12.12 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../draw/index.html">
                        Image Gallery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../community.html">
                        Community
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../licenses.html">
                        License
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../history.html">
                        Project History
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../pycogent.html">
                        How does cogent3 relate to PyCogent?
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../projects.html">
                        Projects using cogent3
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../data_file_links.html">
                        Data Files Used in the Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../genindex.html">
                        Index
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cogent3/cogent3" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../draw/index.html">
                        Image Gallery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../community.html">
                        Community
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../licenses.html">
                        License
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../history.html">
                        Project History
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../pycogent.html">
                        How does cogent3 relate to PyCogent?
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../projects.html">
                        Projects using cogent3
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../data_file_links.html">
                        Data Files Used in the Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../genindex.html">
                        Index
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cogent3/cogent3" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../app/index.html">apps</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../app/index-app.html">Overview of apps</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../app/app-overview.html">Overview of using apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/app-help.html">Getting help on an app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/app-get.html">Getting an app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/available-apps.html">Displaying installed apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/dstore.html">Data stores – collections of data records</a></li>

<li class="toctree-l3"><a class="reference internal" href="../app/not-completed.html">Tracking records that could not be processed</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../app/index-align.html">Sequence Alignment</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../app/align-nucleotide.html">Using a nucleotide model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/align-codon.html">Using a codon model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/align-protein.html">Using a protein model</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../app/index-evo-model.html">Modelling sequence evolution</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-model.html">Apply a non-stationary nucleotide model to an alignment with 3 sequences</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-model-with-tree.html">Apply a non-stationary nucleotide model to an alignment with a tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-model-timehet.html">Specifying a non-stationary model with time-heterogeneous parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-extract-model-stats.html">Extracting maximum likelihood estimates from a <code class="docutils literal notranslate"><span class="pre">model_result</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-ancestral-states.html">Reconstructing ancestral states</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-dt-nuc-model.html">Applying a discrete-time, non-stationary nucleotide model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-tr-nuc-model.html">Applying a time-reversible nucleotide model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-nstat-codon-model.html">Applying GNC, a non-stationary codon model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-tr-codon-model.html">Applying a time-reversible codon model</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../app/index-evo-hypothesis.html">Testing hypotheses about sequence evolution</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-hypothesis.html">Testing a hypothesis – non-stationary or time-reversible</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../app/index-evo-natsel.html">Testing for natural selection</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-natsel_neutral.html"><code class="docutils literal notranslate"><span class="pre">natsel_neutral</span></code> – a test for selective neutrality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-natsel_timehet.html"><code class="docutils literal notranslate"><span class="pre">natsel_timehet</span></code> – a test of branch heterogeneity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-natsel_sitehet.html"><code class="docutils literal notranslate"><span class="pre">natsel_sitehet</span></code> – a test of site heterogeneity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app/evo-natsel_zhang.html"><code class="docutils literal notranslate"><span class="pre">natsel_zhang</span></code> – a branch-site test</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../app/index-custom.html">Write your own Apps</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../app/user_function.html">Turn your functions into composable apps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cookbook/index.html">Cookbook</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cookbook/manipulating_biological_data.html">Manipulating biological data</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/loading_sequences.html">Loading a sequence from a file</a></li>





<li class="toctree-l3"><a class="reference internal" href="../cookbook/DNA_and_RNA_sequences.html">Sequences</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/protein_sequences.html">Protein sequences</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/alignments.html">Sequence Collections and Alignments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/features.html">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/annotation_db.html">Annotation Databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/moltypes.html">Molecular types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/alphabet.html">Alphabets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/what_codes.html">Available genetic codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/genetic_code.html">Using genetic codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/simple_trees.html">Trees</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/tables.html">Tabular data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/building_alignments.html">Building alignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/calc_genetic_distance.html">Genetic distance calculation</a></li>


<li class="toctree-l2"><a class="reference internal" href="../cookbook/building_phylogenies.html">Building phylogenies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/evo_modelling.html">Evolutionary Analysis Using Likelihood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/useful_utilities.html">Useful Utilities</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="align_codons_to_protein.html">Map protein alignment gaps to DNA alignment gaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="manipulating_tree_nodes.html">Manipulation of Tree Node Objects</a></li>

<li class="toctree-l2 current active"><a class="current reference internal" href="#">Estimating periodic signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="simple.html">The simplest script</a></li>
<li class="toctree-l2"><a class="reference internal" href="relative_rate.html">Performing a relative rate test</a></li>
<li class="toctree-l2"><a class="reference internal" href="neutral_test.html">A test of the neutral theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="scope_model_params_on_trees.html">Allowing substitution model parameters to differ between branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="codon_models.html">Using codon models</a></li>
<li class="toctree-l2"><a class="reference internal" href="empirical_protein_models.html">Use an empirical protein substitution model</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing_multi_loci.html">Likelihood analysis of multiple loci</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulate_alignment.html">Simulate an alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="parametric_bootstrap.html">Performing a parametric bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="coevolution.html">Perform a coevolutionary analysis on biological sequence alignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="rate_heterogeneity.html">Analysis of rate heterogeneity</a></li>
<li class="toctree-l2"><a class="reference internal" href="hmm_par_heterogeneity.html">Evaluate process heterogeneity using a Hidden Markov Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculate_pairwise_distances.html">Calculate pairwise distances between sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculate_neigbourjoining_tree.html">Make a neighbor joining tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculate_UPGMA_cluster.html">Make a UPGMA cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="phylo_by_ls.html">Phylogenetic reconstruction by least squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel.html">Parallel computations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.load_seq.html">load_seq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.load_aligned_seqs.html">load_aligned_seqs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.load_unaligned_seqs.html">load_unaligned_seqs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.load_delimited.html">load_delimited</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.load_table.html">load_table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.load_tree.html">load_tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.load_annotations.html">load_annotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.open_data_store.html">open_data_store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.open_.html">open</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.make_seq.html">make_seq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.make_aligned_seqs.html">make_aligned_seqs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.make_unaligned_seqs.html">make_unaligned_seqs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.make_table.html">make_table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.make_tree.html">make_tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.get_code.html">get_code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.get_moltype.html">get_moltype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.get_model.html">get_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.available_codes.html">available_codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.available_moltypes.html">available_moltypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.available_models.html">available_models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/__init__/cogent3.__init__.available_apps.html">available_apps</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/alignment/alignment.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">alignment</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/alignment/classes/cogent3.core.alignment.SequenceCollection.html">SequenceCollection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/alignment/classes/cogent3.core.alignment.Alignment.html">Alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/alignment/classes/cogent3.core.alignment.ArrayAlignment.html">ArrayAlignment</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/annotation/annotation.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">annotation</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/annotation/classes/cogent3.core.annotation.Feature.html">Feature</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/annotation_db/annotation_db.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">annotation_db</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/annotation_db/classes/cogent3.core.annotation_db.BasicAnnotationDb.html">BasicAnnotationDb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/annotation_db/classes/cogent3.core.annotation_db.GffAnnotationDb.html">GffAnnotationDb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/annotation_db/classes/cogent3.core.annotation_db.GenbankAnnotationDb.html">GenbankAnnotationDb</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/sequence/sequence.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sequence</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/sequence/classes/cogent3.core.sequence.DnaSequence.html">DnaSequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/sequence/classes/cogent3.core.sequence.RnaSequence.html">RnaSequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/sequence/classes/cogent3.core.sequence.ProteinSequence.html">ProteinSequence</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/genetic_code/genetic_code.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">genetic_code</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/genetic_code/classes/cogent3.core.genetic_code.GeneticCode.html">GeneticCode</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/moltype/moltype.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">moltype</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/moltype/classes/cogent3.core.moltype.MolType.html">MolType</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/alphabet/alphabet.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">alphabet</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/alphabet/classes/cogent3.core.alphabet.Alphabet.html">Alphabet</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/table/table.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">table</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/table/classes/cogent3.util.table.Table.html">Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/table/classes/cogent3.util.table.Columns.html">Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/table/classes/cogent3.parse.table.FilteringParser.html">FilteringParser</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/tree/tree.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tree</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/tree/classes/cogent3.core.tree.PhyloNode.html">PhyloNode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/app/composable/define_app.html">define_app</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/app/io/classes/cogent3.app.io.register_datastore_reader.html">register_datastore_reader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/app/data_store/classes/cogent3.app.data_store.DataMember.html">DataMember</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/app/data_store/classes/cogent3.app.data_store.DataStoreDirectory.html">DataStoreDirectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/app/data_store/classes/cogent3.app.data_store.ReadOnlyDataStoreZipped.html">ReadOnlyDataStoreZipped</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/app/sqlite_data_store/classes/cogent3.app.sqlite_data_store.DataStoreSqlite.html">DataStoreSqlite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/util/deserialise/deserialise_object.html">deserialise_object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/util/deserialise/classes/cogent3.util.deserialise.register_deserialiser.html">register_deserialiser</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guides</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Estimating...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="estimating-periodic-signals">
<h1>Estimating periodic signals<a class="headerlink" href="#estimating-periodic-signals" title="Link to this heading">#</a></h1>
<p><em>Section author: Gavin Huttley, Julien Epps, Hua Ying</em></p>
<p>We consider two different scenarios:</p>
<ul class="simple">
<li><p>estimating the periods in a signal</p></li>
<li><p>estimating the power for a given period</p></li>
<li><p>measuring statistical significance for the latter case</p></li>
</ul>
<section id="estimating-the-periods-in-a-signal">
<h2>Estimating the periods in a signal<a class="headerlink" href="#estimating-the-periods-in-a-signal" title="Link to this heading">#</a></h2>
<section id="for-numerical-continuous-data">
<h3>For numerical (continuous) data<a class="headerlink" href="#for-numerical-continuous-data" title="Link to this heading">#</a></h3>
<p>We first make some sample data. A periodic signal and some noise.</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">nse</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mf">0.05</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.1</span>
<span class="n">nse</span> <span class="o">=</span> <span class="n">nse</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">nse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<section id="discrete-fourier-transform">
<h4>Discrete Fourier transform<a class="headerlink" href="#discrete-fourier-transform" title="Link to this heading">#</a></h4>
<p>We now use the discrete Fourier transform to estimate periodicity in this signal. Given we set the period to equal 10, we expect the maximum power for that index.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">dft</span>

<span class="n">pwr</span><span class="p">,</span> <span class="n">period</span> <span class="o">=</span> <span class="n">dft</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[  2.           2.04081633   2.08333333   2.12765957   2.17391304
   2.22222222   2.27272727   2.3255814    2.38095238   2.43902439
   2.5          2.56410256   2.63157895   2.7027027    2.77777778
   2.85714286   2.94117647   3.03030303   3.125        3.22580645
   3.33333333   3.44827586   3.57142857   3.7037037    3.84615385
   4.           4.16666667   4.34782609   4.54545455   4.76190476
   5.           5.26315789   5.55555556   5.88235294   6.25
   6.66666667   7.14285714   7.69230769   8.33333333   9.09090909
  10.          11.11111111  12.5         14.28571429  16.66666667
  20.          25.          33.33333333  50.         100.        ]
[ 1.06015801+0.00000000e+00j  0.74686707-1.93971914e-02j
  0.36784793-2.66370366e-02j  0.04384413+2.86970840e-02j
  1.54473269-2.43777386e-02j  0.28522968-2.33602932e-01j
 -0.09908167-8.09083592e-01j -0.17082184-3.71376271e-02j
 -0.89062721+6.28548281e-01j  0.7963791 -3.10035336e-01j
 -0.01840271+7.80492960e-01j  0.88651578-2.41151331e-01j
 -0.19530165-2.51775974e-01j -1.15022781+9.86446405e-01j
  1.08988438-4.80200034e-01j -0.43529315-2.96947078e-01j
 -0.02022101+5.21803410e-01j -0.85047145-1.15731607e+00j
 -1.43688846+1.25736906e-01j -0.24122185+2.99636684e-02j
  1.07237075+9.52126090e-02j -0.82213276+4.00931516e-01j
  0.13867235-2.81517725e-01j -0.49837198-2.77574035e-01j
 -0.46785187-6.22595745e-01j  1.11562242+9.49254299e-01j
  1.1923063 -1.71044818e-01j  1.13909144+4.13690934e-01j
  0.25347752+6.74139986e-02j -0.31153602+9.31846596e-02j
 -0.40472419-6.65748222e-01j -0.20432603-3.45226487e-01j
  0.7243685 -4.04775797e-01j  1.1815508 +4.80212265e-01j
  1.28830449-1.72824059e-01j -0.06062707+4.52301510e-01j
  0.02841505-4.00362778e-01j  0.54158937+1.05374577e+00j
  0.79192147+3.74568790e-01j  1.37803411+4.15026155e-01j
 -0.9707734 -5.07593113e+01j -0.00458776+1.01619914e+00j
  0.72674876+6.73631881e-01j -0.03109358+8.27252853e-01j
 -0.07118569-9.66787987e-01j  0.3787156 +8.78325775e-01j
  0.74358583+9.70454093e-01j  0.09857348+7.64330816e-01j
 -0.58344276-4.46465366e-01j -0.46042799+1.39206718e-01j]
</pre></div>
</div>
</div>
</div>
<p>The power (<code class="docutils literal notranslate"><span class="pre">pwr</span></code>) is returned as an array of complex numbers, so we convert into real numbers using <code class="docutils literal notranslate"><span class="pre">abs</span></code>. We then zip the power and corresponding periods and sort to identify the period with maximum signal.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwr</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
<span class="n">max_pwr</span><span class="p">,</span> <span class="n">max_period</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pwr</span><span class="p">,</span> <span class="n">period</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_pwr</span><span class="p">,</span> <span class="n">max_period</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>50.768593471914606 10.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="auto-correlation">
<h4>Auto-correlation<a class="headerlink" href="#auto-correlation" title="Link to this heading">#</a></h4>
<p>We now use auto-correlation.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">auto_corr</span>

<span class="n">pwr</span><span class="p">,</span> <span class="n">period</span> <span class="o">=</span> <span class="n">auto_corr</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49
 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73
 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97
 98 99]
[ 1.63366075e+01 -1.47309007e+01 -3.99310414e+01 -4.94779387e+01
 -4.02111589e+01 -1.59402206e+01  1.38935958e+01  3.78082033e+01
  4.67917301e+01  3.80558458e+01  1.50298023e+01 -1.31498874e+01
 -3.58750562e+01 -4.44274029e+01 -3.59442269e+01 -1.42494835e+01
  1.23571124e+01  3.37998464e+01  4.19246214e+01  3.40423905e+01
  1.37305496e+01 -1.13403096e+01 -3.11639561e+01 -3.90121298e+01
 -3.19165151e+01 -1.29071920e+01  1.03347404e+01  2.88866727e+01
  3.61923373e+01  2.95836846e+01  1.19272046e+01 -9.60842692e+00
 -2.70680982e+01 -3.36897636e+01 -2.74936245e+01 -1.12432553e+01
  8.85493706e+00  2.50657815e+01  3.12033008e+01  2.55562690e+01
  1.03888477e+01 -8.05790735e+00 -2.29155248e+01 -2.87540424e+01
 -2.35507983e+01 -9.80308843e+00  7.14561492e+00  2.05380855e+01
  2.57732301e+01  2.10932490e+01  8.86322889e+00 -6.14559534e+00
 -1.80666743e+01 -2.27850512e+01 -1.87271137e+01 -7.81441259e+00
  5.36167153e+00  1.61436543e+01  2.02975923e+01  1.66247570e+01
  7.05138114e+00 -4.63658173e+00 -1.41895898e+01 -1.78396501e+01
 -1.46634150e+01 -6.32607996e+00  3.90027551e+00  1.21450065e+01
  1.54316580e+01  1.27121176e+01  5.63814161e+00 -3.03866397e+00
 -9.82623015e+00 -1.24702344e+01 -1.03525898e+01 -4.73098658e+00
  2.24573472e+00  7.60152097e+00  9.58897479e+00  7.92571369e+00
  3.56836331e+00 -1.61934286e+00 -5.69234791e+00 -7.21888050e+00
 -5.98178529e+00 -2.74044320e+00  9.40442056e-01  3.60242842e+00
  4.64669169e+00  3.90300288e+00  2.05204196e+00 -3.23056837e-02
 -1.50585679e+00 -2.11958968e+00 -1.84011202e+00 -1.16394993e+00
 -4.59262996e-01 -9.29507813e-02]
</pre></div>
</div>
</div>
</div>
<p>We then zip the power and corresponding periods and sort to identify the period with maximum signal.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_pwr</span><span class="p">,</span> <span class="n">max_period</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pwr</span><span class="p">,</span> <span class="n">period</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_pwr</span><span class="p">,</span> <span class="n">max_period</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>46.791730073275666 10
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="for-symbolic-data">
<h3>For symbolic data<a class="headerlink" href="#for-symbolic-data" title="Link to this heading">#</a></h3>
<p>We create a sequence as just a string</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;ATCGTTGGGACCGGTTCAAGTTTTGGAACTCGCAAGGGGTGAATGGTCTTCGTCTAACGCTGG&quot;</span>
    <span class="s2">&quot;GGAACCCTGAATCGTTGTAACGCTGGGGTCTTTAACCGTTCTAATTTAACGCTGGGGGGTTCT&quot;</span>
    <span class="s2">&quot;AATTTTTAACCGCGGAATTGCGTC&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>We then specify the motifs whose occurrences will be converted into 1, with all other motifs converted into 0. As we might want to do this in batches for many sequences we use a factory function.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.stats.period</span> <span class="kn">import</span> <span class="n">SeqToSymbols</span>

<span class="n">seq_to_symbols</span> <span class="o">=</span> <span class="n">SeqToSymbols</span><span class="p">([</span><span class="s2">&quot;AA&quot;</span><span class="p">,</span> <span class="s2">&quot;TT&quot;</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">])</span>
<span class="n">symbols</span> <span class="o">=</span> <span class="n">seq_to_symbols</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">symbols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1,
       1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0,
       0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
       0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0,
       1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1,
       0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<p>We then estimate the integer discrete Fourier transform for the full data. To do this, we need to pass in the symbols from full conversion of the sequence. The returned values are the powers and periods.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">ipdft</span>

<span class="n">powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">ipdft</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">powers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([3.22082108e-14, 4.00000000e+00, 9.48683298e+00, 6.74585634e+00,
       3.46410162e+00, 3.20674669e+00, 4.13171488e+00, 1.21157382e+00,
       5.24998151e+00, 8.17918725e+00, 8.83176087e+00, 6.68973168e+00,
       2.30390506e+00, 5.77601816e+00, 7.39581554e+00, 9.80089521e+00,
       1.28140014e+01, 5.59887450e+00, 4.59868328e+00, 8.51990117e+00,
       6.87861072e+00, 2.21002402e+00, 2.99221455e+00, 7.02839146e+00,
       9.56255506e+00, 1.06605556e+01, 1.06350498e+01, 9.87505455e+00,
       8.75521377e+00, 7.58223742e+00, 6.57383339e+00, 5.86043328e+00,
       5.48856222e+00, 5.41967659e+00, 5.54831380e+00, 5.74584888e+00,
       5.89930756e+00, 5.92786864e+00, 5.78419759e+00, 5.45019553e+00,
       4.93168494e+00, 4.25398249e+00, 3.46051662e+00, 2.62061706e+00,
       1.86912424e+00, 1.51346882e+00, 1.83960376e+00, 2.57129507e+00,
       3.40313085e+00, 4.21317980e+00, 4.95053395e+00, 5.58947522e+00,
       6.11597773e+00, 6.52293480e+00, 6.80798765e+00, 6.97227258e+00,
       7.01955788e+00, 6.95558284e+00, 6.78752487e+00, 6.52356140e+00,
       6.17250947e+00, 5.74353209e+00, 5.24590403e+00, 4.68883280e+00,
       4.08133521e+00, 3.43218310e+00, 2.74997407e+00, 2.04355896e+00,
       1.32410691e+00, 6.22045261e-01, 3.65309295e-01, 1.00750601e+00,
       1.73887675e+00, 2.47484570e+00, 3.20342519e+00, 3.91921485e+00,
       4.61856189e+00, 5.29863885e+00, 5.95716246e+00, 6.59227384e+00,
       7.20247125e+00, 7.78656372e+00, 8.34363454e+00, 8.87301027e+00,
       9.37423335e+00, 9.84703756e+00, 1.02913256e+01, 1.07071489e+01,
       1.10946887e+01, 1.14542396e+01, 1.17861941e+01, 1.20910287e+01,
       1.23692910e+01, 1.26215890e+01, 1.28485807e+01, 1.30509645e+01,
       1.32294720e+01, 1.33848600e+01, 1.35179043e+01, 1.36293943e+01,
       1.37201278e+01, 1.37909065e+01, 1.38425325e+01, 1.38758049e+01,
       1.38915172e+01, 1.38904543e+01, 1.38733912e+01, 1.38410910e+01,
       1.37943034e+01, 1.37337637e+01, 1.36601922e+01, 1.35742932e+01,
       1.34767546e+01, 1.33682480e+01, 1.32494280e+01, 1.31209329e+01,
       1.29833845e+01, 1.28373882e+01, 1.26835338e+01, 1.25223958e+01,
       1.23545340e+01, 1.21804940e+01, 1.20008083e+01, 1.18159967e+01,
       1.16265675e+01, 1.14330180e+01, 1.12358361e+01, 1.10355008e+01,
       1.08324839e+01, 1.06272504e+01, 1.04202606e+01, 1.02119707e+01,
       1.00028347e+01, 9.79330530e+00, 9.58383576e+00, 9.37488120e+00,
       9.16690010e+00, 8.96035593e+00, 8.75571856e+00, 8.55346580e+00,
       8.35408477e+00, 8.15807318e+00, 7.96594040e+00, 7.77820828e+00,
       7.59541162e+00, 7.41809819e+00, 7.24682812e+00, 7.08217267e+00])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">periods</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([  2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
        15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,
        41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,
        54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,
        67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,  79,
        80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,
        93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104, 105,
       106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118,
       119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131,
       132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144,
       145, 146, 147, 148, 149])
</pre></div>
</div>
</div>
</div>
<p>We can also compute the auto-correlation statistic, and the hybrid (which combines IPDFT and auto-correlation).</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">auto_corr</span><span class="p">,</span> <span class="n">hybrid</span>

<span class="n">powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">auto_corr</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">powers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([11.,  9., 11.,  9.,  6.,  9.,  7.,  7.,  5.,  6., 11.,  9.,  9.,
        8., 10.,  9.,  4.,  7., 10., 12., 11.,  7.,  9.,  7.,  8.,  5.,
        8.,  9.,  4.,  7.,  7., 11.,  9., 10.,  8.,  7.,  6.,  5.,  5.,
        6.,  3.,  2.,  3.,  6.,  5.,  4.,  7.,  5.,  6.,  8.,  7.,  6.,
        4.,  8.,  5.,  5.,  4.,  5.,  7.,  6.,  3.,  4.,  5.,  5.,  4.,
        4.,  6.,  4.,  3.,  3.,  5.,  6.,  5.,  4.,  4.,  5.,  3.,  5.,
        5.,  5.,  3.,  2.,  5.,  6.,  6.,  6.,  6.,  6.,  4.,  3.,  3.,
        5.,  4.,  2.,  4.,  2.,  1.,  1.,  5.,  6.,  4.,  2.,  3.,  5.,
        5.,  5.,  6.,  5.,  5.,  3.,  3.,  3.,  2.,  2.,  3.,  2.,  1.,
        2.,  2.,  3.,  4.,  2.,  2.,  2.,  3.,  3.,  2.,  3.,  1.,  1.,
        0.,  1.,  0.,  0.,  0.,  1.,  1.,  1.,  0.,  1.,  1.,  1.,  0.,
        0.,  0.,  0.,  0.,  0.])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">periods</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([  2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
        15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,
        41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,
        54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,
        67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,  79,
        80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,
        93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104, 105,
       106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118,
       119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131,
       132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144,
       145, 146, 147, 148, 149])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">hybrid</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">powers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([3.54290319e-13, 3.60000000e+01, 1.04355163e+02, 6.07127071e+01,
       2.07846097e+01, 2.88607202e+01, 2.89220041e+01, 8.48101672e+00,
       2.62499076e+01, 4.90751235e+01, 9.71493695e+01, 6.02075851e+01,
       2.07351455e+01, 4.62081453e+01, 7.39581554e+01, 8.82080569e+01,
       5.12560056e+01, 3.91921215e+01, 4.59868328e+01, 1.02238814e+02,
       7.56647179e+01, 1.54701681e+01, 2.69299309e+01, 4.91987402e+01,
       7.65004405e+01, 5.33027778e+01, 8.50803983e+01, 8.88754909e+01,
       3.50208551e+01, 5.30756620e+01, 4.60168337e+01, 6.44647661e+01,
       4.93970600e+01, 5.41967659e+01, 4.43865104e+01, 4.02209421e+01,
       3.53958454e+01, 2.96393432e+01, 2.89209880e+01, 3.27011732e+01,
       1.47950548e+01, 8.50796497e+00, 1.03815499e+01, 1.57237024e+01,
       9.34562120e+00, 6.05387527e+00, 1.28772263e+01, 1.28564753e+01,
       2.04187851e+01, 3.37054384e+01, 3.46537377e+01, 3.35368513e+01,
       2.44639109e+01, 5.21834784e+01, 3.40399383e+01, 3.48613629e+01,
       2.80782315e+01, 3.47779142e+01, 4.75126741e+01, 3.91413684e+01,
       1.85175284e+01, 2.29741283e+01, 2.62295201e+01, 2.34441640e+01,
       1.63253408e+01, 1.37287324e+01, 1.64998444e+01, 8.17423584e+00,
       3.97232072e+00, 1.86613578e+00, 1.82654647e+00, 6.04503603e+00,
       8.69438374e+00, 9.89938281e+00, 1.28137008e+01, 1.95960742e+01,
       1.38556857e+01, 2.64931942e+01, 2.97858123e+01, 3.29613692e+01,
       2.16074137e+01, 1.55731274e+01, 4.17181727e+01, 5.32380616e+01,
       5.62454001e+01, 5.90822254e+01, 6.17479537e+01, 6.42428932e+01,
       4.43787546e+01, 3.43627188e+01, 3.53585824e+01, 6.04551433e+01,
       4.94771639e+01, 2.52431781e+01, 5.13943227e+01, 2.61019291e+01,
       1.32294720e+01, 1.33848600e+01, 6.75895216e+01, 8.17763660e+01,
       5.48805111e+01, 2.75818129e+01, 4.15275974e+01, 6.93790246e+01,
       6.94575858e+01, 6.94522714e+01, 8.32403473e+01, 6.92054550e+01,
       6.89715168e+01, 4.12012911e+01, 4.09805767e+01, 4.07228795e+01,
       2.69535092e+01, 2.67364959e+01, 3.97482840e+01, 2.62418659e+01,
       1.29833845e+01, 2.56747763e+01, 2.53670676e+01, 3.75671874e+01,
       4.94181358e+01, 2.43609880e+01, 2.40016166e+01, 2.36319935e+01,
       3.48797024e+01, 3.42990539e+01, 2.24716721e+01, 3.31065025e+01,
       1.08324839e+01, 1.06272504e+01, 0.00000000e+00, 1.02119707e+01,
       0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 9.37488120e+00,
       9.16690010e+00, 8.96035593e+00, 0.00000000e+00, 8.55346580e+00,
       8.35408477e+00, 8.15807318e+00, 0.00000000e+00, 0.00000000e+00,
       0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">periods</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([  2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
        15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,
        41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,
        54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,
        67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,  79,
        80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,
        93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104, 105,
       106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118,
       119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131,
       132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144,
       145, 146, 147, 148, 149])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="estimating-power-for-specified-period">
<h2>Estimating power for specified period<a class="headerlink" href="#estimating-power-for-specified-period" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>For numerical (continuous) data<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>We just use <code class="docutils literal notranslate"><span class="pre">sig</span></code> created above. The Goertzel algorithm gives the same result as the <code class="docutils literal notranslate"><span class="pre">dft</span></code>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">goertzel</span>

<span class="n">pwr</span> <span class="o">=</span> <span class="n">goertzel</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>50.76859347191462
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>For symbolic data<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>We use the symbols from the above example. For the <code class="docutils literal notranslate"><span class="pre">ipdft</span></code>, <code class="docutils literal notranslate"><span class="pre">auto_corr</span></code> and <code class="docutils literal notranslate"><span class="pre">hybrid</span></code> functions we just need to identify the array index containing the period of interest and slice the corresponding value from the returned powers. The reported periods start at <code class="docutils literal notranslate"><span class="pre">llim</span></code>, which defaults to 2, but indexes start at 0, the index for a period-5 is simply 5-<code class="docutils literal notranslate"><span class="pre">llim</span></code>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">auto_corr</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">llim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">period5</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">llim</span>
<span class="n">periods</span><span class="p">[</span><span class="n">period5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">powers</span><span class="p">[</span><span class="n">period5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>9.0
</pre></div>
</div>
</div>
</div>
<p>For Fourier techniques, we can compute the power for a specific period more efficiently using Goertzel algorithm.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">goertzel</span>

<span class="n">period</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">power</span> <span class="o">=</span> <span class="n">goertzel</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
<span class="n">ipdft_powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">ipdft</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">ipdft_power</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ipdft_powers</span><span class="p">[</span><span class="n">period</span> <span class="o">-</span> <span class="n">llim</span><span class="p">])</span>
<span class="nb">round</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="nb">round</span><span class="p">(</span><span class="n">ipdft_power</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">power</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>9.486832980505154
</pre></div>
</div>
</div>
</div>
<p>It’s also possible to specify a period to the stand-alone functions. As per the <code class="docutils literal notranslate"><span class="pre">goertzel</span></code> function, just the power is returned.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power</span> <span class="o">=</span> <span class="n">hybrid</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">)</span>
<span class="n">power</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>104.35516278555667
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="measuring-statistical-significance-of-periodic-signals">
<h2>Measuring statistical significance of periodic signals<a class="headerlink" href="#measuring-statistical-significance-of-periodic-signals" title="Link to this heading">#</a></h2>
<section id="id3">
<h3>For numerical (continuous data)<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>We use the signal provided above. Because significance testing is being done using a resampling approach, we define a calculator which precomputes some values to improve compute performance. For a continuous signal, we’ll use the Goertzel algorithm.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">Goertzel</span>

<span class="n">goertzel_calc</span> <span class="o">=</span> <span class="n">Goertzel</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="p">),</span> <span class="n">period</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Having defined this, we then just pass this calculator to the <code class="docutils literal notranslate"><span class="pre">blockwise_bootstrap</span></code> function. The other critical settings are the <code class="docutils literal notranslate"><span class="pre">block_size</span></code> which specifies the size of segments of contiguous sequence positions to use for sampling and <code class="docutils literal notranslate"><span class="pre">num_reps</span></code> which is the number of permuted replicate sequences to generate.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.stats.period</span> <span class="kn">import</span> <span class="n">blockwise_bootstrap</span>

<span class="n">obs_stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">blockwise_bootstrap</span><span class="p">(</span>
    <span class="n">sig</span><span class="p">,</span> <span class="n">calc</span><span class="o">=</span><span class="n">goertzel_calc</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_reps</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs_stat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>50.76859347191462
0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>For symbolic data<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<section id="permutation-testing">
<h4>Permutation testing<a class="headerlink" href="#permutation-testing" title="Link to this heading">#</a></h4>
<p>The very notion of permutation testing for periods, applied to a genome, requires the compute performance be as quick as possible. This means providing as much information up front as possible. We have made the implementation flexible by not assuming how the user will convert sequences to symbols. It’s also the case that numerous windows of exactly the same size are being assessed. Accordingly, we use a class to construct a fixed signal length evaluator. We do this for the hybrid metric first.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">Hybrid</span>

<span class="n">hybrid_calculator</span> <span class="o">=</span> <span class="n">Hybrid</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">period</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We defined the period length of interest in defining this calculator because we’re interested in dinucleotide motifs.</p>
</div>
<p>We then construct a seq-to-symbol convertor.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.stats.period</span> <span class="kn">import</span> <span class="n">SeqToSymbols</span>

<span class="n">seq_to_symbols</span> <span class="o">=</span> <span class="n">SeqToSymbols</span><span class="p">([</span><span class="s2">&quot;AA&quot;</span><span class="p">,</span> <span class="s2">&quot;TT&quot;</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">],</span> <span class="n">length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The rest is as per the analysis using <code class="docutils literal notranslate"><span class="pre">Goertzel</span></code> above.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.stats.period</span> <span class="kn">import</span> <span class="n">blockwise_bootstrap</span>

<span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">blockwise_bootstrap</span><span class="p">(</span>
    <span class="n">s</span><span class="p">,</span>
    <span class="n">calc</span><span class="o">=</span><span class="n">hybrid_calculator</span><span class="p">,</span>
    <span class="n">block_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">num_reps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">seq_to_symbols</span><span class="o">=</span><span class="n">seq_to_symbols</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
<span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>104.35516278555667
</pre></div>
</div>
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="manipulating_tree_nodes.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Manipulation of Tree Node Objects</p>
      </div>
    </a>
    <a class="right-next"
       href="simple.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The simplest script</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-periods-in-a-signal">Estimating the periods in a signal</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-numerical-continuous-data">For numerical (continuous) data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discrete-fourier-transform">Discrete Fourier transform</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#auto-correlation">Auto-correlation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-symbolic-data">For symbolic data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-power-for-specified-period">Estimating power for specified period</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">For numerical (continuous) data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">For symbolic data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-statistical-significance-of-periodic-signals">Measuring statistical significance of periodic signals</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">For numerical (continuous data)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">For symbolic data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#permutation-testing">Permutation testing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2020-2023, cogent3 Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>