<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estimating periodic signals &#8212; cogent3 2020.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-dropdown.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="../../_static/require.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          cogent3</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../install.html">Install</a></li>
                <li><a href="../index.html">Docs</a></li>
                <li><a href="../draw/index.html">Gallery</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../draw/index.html">Image Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general.html">Posting Bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general.html#citation">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general.html#support">Support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">Project History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pycogent.html">How does <code class="docutils literal notranslate"><span class="pre">cogent3</span></code> relate to PyCogent?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projects.html">Projects using <code class="docutils literal notranslate"><span class="pre">cogent3</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../licenses.html">License</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Estimating periodic signals</a><ul>
<li><a class="reference internal" href="#estimating-the-periods-in-a-signal">Estimating the periods in a signal</a><ul>
<li><a class="reference internal" href="#for-numerical-continuous-data">For numerical (continuous) data</a><ul>
<li><a class="reference internal" href="#discrete-fourier-transform">Discrete Fourier transform</a></li>
<li><a class="reference internal" href="#auto-correlation">Auto-correlation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#for-symbolic-data">For symbolic data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#estimating-power-for-specified-period">Estimating power for specified period</a><ul>
<li><a class="reference internal" href="#id1">For numerical (continuous) data</a></li>
<li><a class="reference internal" href="#id2">For symbolic data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#measuring-statistical-significance-of-periodic-signals">Measuring statistical significance of periodic signals</a><ul>
<li><a class="reference internal" href="#id3">For numerical (continuous data)</a></li>
<li><a class="reference internal" href="#id4">For symbolic data</a><ul>
<li><a class="reference internal" href="#permutation-testing">Permutation testing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="estimating-periodic-signals">
<h1>Estimating periodic signals<a class="headerlink" href="#estimating-periodic-signals" title="Permalink to this headline">¶</a></h1>
<p><em>Section author: Gavin Huttley, Julien Epps, Hua Ying</em></p>
<p>We consider two different scenarios:</p>
<ul class="simple">
<li><p>estimating the periods in a signal</p></li>
<li><p>estimating the power for a given period</p></li>
<li><p>measuring statistical significance for the latter case</p></li>
</ul>
<div class="section" id="estimating-the-periods-in-a-signal">
<h2>Estimating the periods in a signal<a class="headerlink" href="#estimating-the-periods-in-a-signal" title="Permalink to this headline">¶</a></h2>
<div class="section" id="for-numerical-continuous-data">
<h3>For numerical (continuous) data<a class="headerlink" href="#for-numerical-continuous-data" title="Permalink to this headline">¶</a></h3>
<p>We first make some sample data. A periodic signal and some noise.</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">nse</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mf">0.05</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.1</span>
<span class="n">nse</span> <span class="o">=</span> <span class="n">nse</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">nse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="section" id="discrete-fourier-transform">
<h4>Discrete Fourier transform<a class="headerlink" href="#discrete-fourier-transform" title="Permalink to this headline">¶</a></h4>
<p>We now use the discrete Fourier transform to estimate periodicity in this signal. Given we set the period to equal 10, we expect the maximum power for that index.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">dft</span>

<span class="n">pwr</span><span class="p">,</span> <span class="n">period</span> <span class="o">=</span> <span class="n">dft</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[  2.           2.04081633   2.08333333   2.12765957   2.17391304
   2.22222222   2.27272727   2.3255814    2.38095238   2.43902439
   2.5          2.56410256   2.63157895   2.7027027    2.77777778
   2.85714286   2.94117647   3.03030303   3.125        3.22580645
   3.33333333   3.44827586   3.57142857   3.7037037    3.84615385
   4.           4.16666667   4.34782609   4.54545455   4.76190476
   5.           5.26315789   5.55555556   5.88235294   6.25
   6.66666667   7.14285714   7.69230769   8.33333333   9.09090909
  10.          11.11111111  12.5         14.28571429  16.66666667
  20.          25.          33.33333333  50.         100.        ]
[ 1.06015801+0.00000000e+00j  0.74686707-1.93971914e-02j
  0.36784793-2.66370366e-02j  0.04384413+2.86970840e-02j
  1.54473269-2.43777386e-02j  0.28522968-2.33602932e-01j
 -0.09908167-8.09083592e-01j -0.17082184-3.71376271e-02j
 -0.89062721+6.28548281e-01j  0.7963791 -3.10035336e-01j
 -0.01840271+7.80492960e-01j  0.88651578-2.41151331e-01j
 -0.19530165-2.51775974e-01j -1.15022781+9.86446405e-01j
  1.08988438-4.80200034e-01j -0.43529315-2.96947078e-01j
 -0.02022101+5.21803410e-01j -0.85047145-1.15731607e+00j
 -1.43688846+1.25736906e-01j -0.24122185+2.99636684e-02j
  1.07237075+9.52126090e-02j -0.82213276+4.00931516e-01j
  0.13867235-2.81517725e-01j -0.49837198-2.77574035e-01j
 -0.46785187-6.22595745e-01j  1.11562242+9.49254299e-01j
  1.1923063 -1.71044818e-01j  1.13909144+4.13690934e-01j
  0.25347752+6.74139986e-02j -0.31153602+9.31846596e-02j
 -0.40472419-6.65748222e-01j -0.20432603-3.45226487e-01j
  0.7243685 -4.04775797e-01j  1.1815508 +4.80212265e-01j
  1.28830449-1.72824059e-01j -0.06062707+4.52301510e-01j
  0.02841505-4.00362778e-01j  0.54158937+1.05374577e+00j
  0.79192147+3.74568790e-01j  1.37803411+4.15026155e-01j
 -0.9707734 -5.07593113e+01j -0.00458776+1.01619914e+00j
  0.72674876+6.73631881e-01j -0.03109358+8.27252853e-01j
 -0.07118569-9.66787987e-01j  0.3787156 +8.78325775e-01j
  0.74358583+9.70454093e-01j  0.09857348+7.64330816e-01j
 -0.58344276-4.46465366e-01j -0.46042799+1.39206718e-01j]
</pre></div>
</div>
</div>
</div>
<p>The power (<code class="docutils literal notranslate"><span class="pre">pwr</span></code>) is returned as an array of complex numbers, so we convert into real numbers using <code class="docutils literal notranslate"><span class="pre">abs</span></code>. We then zip the power and corresponding periods and sort to identify the period with maximum signal.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pwr</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
<span class="n">max_pwr</span><span class="p">,</span> <span class="n">max_period</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pwr</span><span class="p">,</span> <span class="n">period</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_pwr</span><span class="p">,</span> <span class="n">max_period</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>50.768593471914606 10.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="auto-correlation">
<h4>Auto-correlation<a class="headerlink" href="#auto-correlation" title="Permalink to this headline">¶</a></h4>
<p>We now use auto-correlation.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">auto_corr</span>

<span class="n">pwr</span><span class="p">,</span> <span class="n">period</span> <span class="o">=</span> <span class="n">auto_corr</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49
 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73
 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97
 98 99]
[ 1.63366075e+01 -1.47309007e+01 -3.99310414e+01 -4.94779387e+01
 -4.02111589e+01 -1.59402206e+01  1.38935958e+01  3.78082033e+01
  4.67917301e+01  3.80558458e+01  1.50298023e+01 -1.31498874e+01
 -3.58750562e+01 -4.44274029e+01 -3.59442269e+01 -1.42494835e+01
  1.23571124e+01  3.37998464e+01  4.19246214e+01  3.40423905e+01
  1.37305496e+01 -1.13403096e+01 -3.11639561e+01 -3.90121298e+01
 -3.19165151e+01 -1.29071920e+01  1.03347404e+01  2.88866727e+01
  3.61923373e+01  2.95836846e+01  1.19272046e+01 -9.60842692e+00
 -2.70680982e+01 -3.36897636e+01 -2.74936245e+01 -1.12432553e+01
  8.85493706e+00  2.50657815e+01  3.12033008e+01  2.55562690e+01
  1.03888477e+01 -8.05790735e+00 -2.29155248e+01 -2.87540424e+01
 -2.35507983e+01 -9.80308843e+00  7.14561492e+00  2.05380855e+01
  2.57732301e+01  2.10932490e+01  8.86322889e+00 -6.14559534e+00
 -1.80666743e+01 -2.27850512e+01 -1.87271137e+01 -7.81441259e+00
  5.36167153e+00  1.61436543e+01  2.02975923e+01  1.66247570e+01
  7.05138114e+00 -4.63658173e+00 -1.41895898e+01 -1.78396501e+01
 -1.46634150e+01 -6.32607996e+00  3.90027551e+00  1.21450065e+01
  1.54316580e+01  1.27121176e+01  5.63814161e+00 -3.03866397e+00
 -9.82623015e+00 -1.24702344e+01 -1.03525898e+01 -4.73098658e+00
  2.24573472e+00  7.60152097e+00  9.58897479e+00  7.92571369e+00
  3.56836331e+00 -1.61934286e+00 -5.69234791e+00 -7.21888050e+00
 -5.98178529e+00 -2.74044320e+00  9.40442056e-01  3.60242842e+00
  4.64669169e+00  3.90300288e+00  2.05204196e+00 -3.23056837e-02
 -1.50585679e+00 -2.11958968e+00 -1.84011202e+00 -1.16394993e+00
 -4.59262996e-01 -9.29507813e-02]
</pre></div>
</div>
</div>
</div>
<p>We then zip the power and corresponding periods and sort to identify the period with maximum signal.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_pwr</span><span class="p">,</span> <span class="n">max_period</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pwr</span><span class="p">,</span> <span class="n">period</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_pwr</span><span class="p">,</span> <span class="n">max_period</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>46.791730073275666 10
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="for-symbolic-data">
<h3>For symbolic data<a class="headerlink" href="#for-symbolic-data" title="Permalink to this headline">¶</a></h3>
<p>We create a sequence as just a string</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;ATCGTTGGGACCGGTTCAAGTTTTGGAACTCGCAAGGGGTGAATGGTCTTCGTCTAACGCTGG&quot;</span>
    <span class="s2">&quot;GGAACCCTGAATCGTTGTAACGCTGGGGTCTTTAACCGTTCTAATTTAACGCTGGGGGGTTCT&quot;</span>
    <span class="s2">&quot;AATTTTTAACCGCGGAATTGCGTC&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>We then specify the motifs whose occurrences will be converted into 1, with all other motifs converted into 0. As we might want to do this in batches for many sequences we use a factory function.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.stats.period</span> <span class="kn">import</span> <span class="n">SeqToSymbols</span>

<span class="n">seq_to_symbols</span> <span class="o">=</span> <span class="n">SeqToSymbols</span><span class="p">([</span><span class="s2">&quot;AA&quot;</span><span class="p">,</span> <span class="s2">&quot;TT&quot;</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">])</span>
<span class="n">symbols</span> <span class="o">=</span> <span class="n">seq_to_symbols</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">symbols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1,
       1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0,
       0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
       0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0,
       1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1,
       0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<p>We then estimate the integer discrete Fourier transform for the full data. To do this, we need to pass in the symbols from full conversion of the sequence. The returned values are the powers and periods.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">ipdft</span>

<span class="n">powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">ipdft</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">powers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([3.22082108e-14, 4.00000000e+00, 9.48683298e+00, 6.74585634e+00,
       3.46410162e+00, 3.20674669e+00, 4.13171488e+00, 1.21157382e+00,
       5.24998151e+00, 8.17918725e+00, 8.83176087e+00, 6.68973168e+00,
       2.30390506e+00, 5.77601816e+00, 7.39581554e+00, 9.80089521e+00,
       1.28140014e+01, 5.59887450e+00, 4.59868328e+00, 8.51990117e+00,
       6.87861072e+00, 2.21002402e+00, 2.99221455e+00, 7.02839146e+00,
       9.56255506e+00, 1.06605556e+01, 1.06350498e+01, 9.87505455e+00,
       8.75521377e+00, 7.58223742e+00, 6.57383339e+00, 5.86043328e+00,
       5.48856222e+00, 5.41967659e+00, 5.54831380e+00, 5.74584888e+00,
       5.89930756e+00, 5.92786864e+00, 5.78419759e+00, 5.45019553e+00,
       4.93168494e+00, 4.25398249e+00, 3.46051662e+00, 2.62061706e+00,
       1.86912424e+00, 1.51346882e+00, 1.83960376e+00, 2.57129507e+00,
       3.40313085e+00, 4.21317980e+00, 4.95053395e+00, 5.58947522e+00,
       6.11597773e+00, 6.52293480e+00, 6.80798765e+00, 6.97227258e+00,
       7.01955788e+00, 6.95558284e+00, 6.78752487e+00, 6.52356140e+00,
       6.17250947e+00, 5.74353209e+00, 5.24590403e+00, 4.68883280e+00,
       4.08133521e+00, 3.43218310e+00, 2.74997407e+00, 2.04355896e+00,
       1.32410691e+00, 6.22045261e-01, 3.65309295e-01, 1.00750601e+00,
       1.73887675e+00, 2.47484570e+00, 3.20342519e+00, 3.91921485e+00,
       4.61856189e+00, 5.29863885e+00, 5.95716246e+00, 6.59227384e+00,
       7.20247125e+00, 7.78656372e+00, 8.34363454e+00, 8.87301027e+00,
       9.37423335e+00, 9.84703756e+00, 1.02913256e+01, 1.07071489e+01,
       1.10946887e+01, 1.14542396e+01, 1.17861941e+01, 1.20910287e+01,
       1.23692910e+01, 1.26215890e+01, 1.28485807e+01, 1.30509645e+01,
       1.32294720e+01, 1.33848600e+01, 1.35179043e+01, 1.36293943e+01,
       1.37201278e+01, 1.37909065e+01, 1.38425325e+01, 1.38758049e+01,
       1.38915172e+01, 1.38904543e+01, 1.38733912e+01, 1.38410910e+01,
       1.37943034e+01, 1.37337637e+01, 1.36601922e+01, 1.35742932e+01,
       1.34767546e+01, 1.33682480e+01, 1.32494280e+01, 1.31209329e+01,
       1.29833845e+01, 1.28373882e+01, 1.26835338e+01, 1.25223958e+01,
       1.23545340e+01, 1.21804940e+01, 1.20008083e+01, 1.18159967e+01,
       1.16265675e+01, 1.14330180e+01, 1.12358361e+01, 1.10355008e+01,
       1.08324839e+01, 1.06272504e+01, 1.04202606e+01, 1.02119707e+01,
       1.00028347e+01, 9.79330530e+00, 9.58383576e+00, 9.37488120e+00,
       9.16690010e+00, 8.96035593e+00, 8.75571856e+00, 8.55346580e+00,
       8.35408477e+00, 8.15807318e+00, 7.96594040e+00, 7.77820828e+00,
       7.59541162e+00, 7.41809819e+00, 7.24682812e+00, 7.08217267e+00])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">periods</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([  2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
        15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,
        41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,
        54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,
        67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,  79,
        80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,
        93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104, 105,
       106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118,
       119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131,
       132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144,
       145, 146, 147, 148, 149])
</pre></div>
</div>
</div>
</div>
<p>We can also compute the auto-correlation statistic, and the hybrid (which combines IPDFT and auto-correlation).</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">auto_corr</span><span class="p">,</span> <span class="n">hybrid</span>

<span class="n">powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">auto_corr</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">powers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([11.,  9., 11.,  9.,  6.,  9.,  7.,  7.,  5.,  6., 11.,  9.,  9.,
        8., 10.,  9.,  4.,  7., 10., 12., 11.,  7.,  9.,  7.,  8.,  5.,
        8.,  9.,  4.,  7.,  7., 11.,  9., 10.,  8.,  7.,  6.,  5.,  5.,
        6.,  3.,  2.,  3.,  6.,  5.,  4.,  7.,  5.,  6.,  8.,  7.,  6.,
        4.,  8.,  5.,  5.,  4.,  5.,  7.,  6.,  3.,  4.,  5.,  5.,  4.,
        4.,  6.,  4.,  3.,  3.,  5.,  6.,  5.,  4.,  4.,  5.,  3.,  5.,
        5.,  5.,  3.,  2.,  5.,  6.,  6.,  6.,  6.,  6.,  4.,  3.,  3.,
        5.,  4.,  2.,  4.,  2.,  1.,  1.,  5.,  6.,  4.,  2.,  3.,  5.,
        5.,  5.,  6.,  5.,  5.,  3.,  3.,  3.,  2.,  2.,  3.,  2.,  1.,
        2.,  2.,  3.,  4.,  2.,  2.,  2.,  3.,  3.,  2.,  3.,  1.,  1.,
        0.,  1.,  0.,  0.,  0.,  1.,  1.,  1.,  0.,  1.,  1.,  1.,  0.,
        0.,  0.,  0.,  0.,  0.])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">periods</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([  2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
        15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,
        41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,
        54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,
        67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,  79,
        80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,
        93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104, 105,
       106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118,
       119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131,
       132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144,
       145, 146, 147, 148, 149])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">hybrid</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">powers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([3.54290319e-13, 3.60000000e+01, 1.04355163e+02, 6.07127071e+01,
       2.07846097e+01, 2.88607202e+01, 2.89220041e+01, 8.48101672e+00,
       2.62499076e+01, 4.90751235e+01, 9.71493695e+01, 6.02075851e+01,
       2.07351455e+01, 4.62081453e+01, 7.39581554e+01, 8.82080569e+01,
       5.12560056e+01, 3.91921215e+01, 4.59868328e+01, 1.02238814e+02,
       7.56647179e+01, 1.54701681e+01, 2.69299309e+01, 4.91987402e+01,
       7.65004405e+01, 5.33027778e+01, 8.50803983e+01, 8.88754909e+01,
       3.50208551e+01, 5.30756620e+01, 4.60168337e+01, 6.44647661e+01,
       4.93970600e+01, 5.41967659e+01, 4.43865104e+01, 4.02209421e+01,
       3.53958454e+01, 2.96393432e+01, 2.89209880e+01, 3.27011732e+01,
       1.47950548e+01, 8.50796497e+00, 1.03815499e+01, 1.57237024e+01,
       9.34562120e+00, 6.05387527e+00, 1.28772263e+01, 1.28564753e+01,
       2.04187851e+01, 3.37054384e+01, 3.46537377e+01, 3.35368513e+01,
       2.44639109e+01, 5.21834784e+01, 3.40399383e+01, 3.48613629e+01,
       2.80782315e+01, 3.47779142e+01, 4.75126741e+01, 3.91413684e+01,
       1.85175284e+01, 2.29741283e+01, 2.62295201e+01, 2.34441640e+01,
       1.63253408e+01, 1.37287324e+01, 1.64998444e+01, 8.17423584e+00,
       3.97232072e+00, 1.86613578e+00, 1.82654647e+00, 6.04503603e+00,
       8.69438374e+00, 9.89938281e+00, 1.28137008e+01, 1.95960742e+01,
       1.38556857e+01, 2.64931942e+01, 2.97858123e+01, 3.29613692e+01,
       2.16074137e+01, 1.55731274e+01, 4.17181727e+01, 5.32380616e+01,
       5.62454001e+01, 5.90822254e+01, 6.17479537e+01, 6.42428932e+01,
       4.43787546e+01, 3.43627188e+01, 3.53585824e+01, 6.04551433e+01,
       4.94771639e+01, 2.52431781e+01, 5.13943227e+01, 2.61019291e+01,
       1.32294720e+01, 1.33848600e+01, 6.75895216e+01, 8.17763660e+01,
       5.48805111e+01, 2.75818129e+01, 4.15275974e+01, 6.93790246e+01,
       6.94575858e+01, 6.94522714e+01, 8.32403473e+01, 6.92054550e+01,
       6.89715168e+01, 4.12012911e+01, 4.09805767e+01, 4.07228795e+01,
       2.69535092e+01, 2.67364959e+01, 3.97482840e+01, 2.62418659e+01,
       1.29833845e+01, 2.56747763e+01, 2.53670676e+01, 3.75671874e+01,
       4.94181358e+01, 2.43609880e+01, 2.40016166e+01, 2.36319935e+01,
       3.48797024e+01, 3.42990539e+01, 2.24716721e+01, 3.31065025e+01,
       1.08324839e+01, 1.06272504e+01, 0.00000000e+00, 1.02119707e+01,
       0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 9.37488120e+00,
       9.16690010e+00, 8.96035593e+00, 0.00000000e+00, 8.55346580e+00,
       8.35408477e+00, 8.15807318e+00, 0.00000000e+00, 0.00000000e+00,
       0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00])
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">periods</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([  2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
        15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,
        41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,
        54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,
        67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,  79,
        80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,
        93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104, 105,
       106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118,
       119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131,
       132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144,
       145, 146, 147, 148, 149])
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="estimating-power-for-specified-period">
<h2>Estimating power for specified period<a class="headerlink" href="#estimating-power-for-specified-period" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>For numerical (continuous) data<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>We just use <code class="docutils literal notranslate"><span class="pre">sig</span></code> created above. The Goertzel algorithm gives the same result as the <code class="docutils literal notranslate"><span class="pre">dft</span></code>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">goertzel</span>

<span class="n">pwr</span> <span class="o">=</span> <span class="n">goertzel</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>50.76859347191462
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>For symbolic data<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>We use the symbols from the above example. For the <code class="docutils literal notranslate"><span class="pre">ipdft</span></code>, <code class="docutils literal notranslate"><span class="pre">auto_corr</span></code> and <code class="docutils literal notranslate"><span class="pre">hybrid</span></code> functions we just need to identify the array index containing the period of interest and slice the corresponding value from the returned powers. The reported periods start at <code class="docutils literal notranslate"><span class="pre">llim</span></code>, which defaults to 2, but indexes start at 0, the index for a period-5 is simply 5-<code class="docutils literal notranslate"><span class="pre">llim</span></code>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">auto_corr</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">llim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">period5</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">llim</span>
<span class="n">periods</span><span class="p">[</span><span class="n">period5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">powers</span><span class="p">[</span><span class="n">period5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>9.0
</pre></div>
</div>
</div>
</div>
<p>For Fourier techniques, we can compute the power for a specific period more efficiently using Goertzel algorithm.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">goertzel</span>

<span class="n">period</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">power</span> <span class="o">=</span> <span class="n">goertzel</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
<span class="n">ipdft_powers</span><span class="p">,</span> <span class="n">periods</span> <span class="o">=</span> <span class="n">ipdft</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
<span class="n">ipdft_power</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ipdft_powers</span><span class="p">[</span><span class="n">period</span> <span class="o">-</span> <span class="n">llim</span><span class="p">])</span>
<span class="nb">round</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="nb">round</span><span class="p">(</span><span class="n">ipdft_power</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">power</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>9.486832980505154
</pre></div>
</div>
</div>
</div>
<p>It’s also possible to specify a period to the stand-alone functions. As per the <code class="docutils literal notranslate"><span class="pre">goertzel</span></code> function, just the power is returned.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">power</span> <span class="o">=</span> <span class="n">hybrid</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">)</span>
<span class="n">power</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>104.35516278555667
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="measuring-statistical-significance-of-periodic-signals">
<h2>Measuring statistical significance of periodic signals<a class="headerlink" href="#measuring-statistical-significance-of-periodic-signals" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>For numerical (continuous data)<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>We use the signal provided above. Because significance testing is being done using a resampling approach, we define a calculator which precomputes some values to improve compute performance. For a continuous signal, we’ll use the Goertzel algorithm.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">Goertzel</span>

<span class="n">goertzel_calc</span> <span class="o">=</span> <span class="n">Goertzel</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="p">),</span> <span class="n">period</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Having defined this, we then just pass this calculator to the <code class="docutils literal notranslate"><span class="pre">blockwise_bootstrap</span></code> function. The other critical settings are the <code class="docutils literal notranslate"><span class="pre">block_size</span></code> which specifies the size of segments of contiguous sequence positions to use for sampling and <code class="docutils literal notranslate"><span class="pre">num_reps</span></code> which is the number of permuted replicate sequences to generate.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.stats.period</span> <span class="kn">import</span> <span class="n">blockwise_bootstrap</span>

<span class="n">obs_stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">blockwise_bootstrap</span><span class="p">(</span>
    <span class="n">sig</span><span class="p">,</span> <span class="n">calc</span><span class="o">=</span><span class="n">goertzel_calc</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_reps</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs_stat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>50.76859347191462
0.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>For symbolic data<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="section" id="permutation-testing">
<h4>Permutation testing<a class="headerlink" href="#permutation-testing" title="Permalink to this headline">¶</a></h4>
<p>The very notion of permutation testing for periods, applied to a genome, requires the compute performance be as quick as possible. This means providing as much information up front as possible. We have made the implementation flexible by not assuming how the user will convert sequences to symbols. It’s also the case that numerous windows of exactly the same size are being assessed. Accordingly, we use a class to construct a fixed signal length evaluator. We do this for the hybrid metric first.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.period</span> <span class="kn">import</span> <span class="n">Hybrid</span>

<span class="n">hybrid_calculator</span> <span class="o">=</span> <span class="n">Hybrid</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">period</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We defined the period length of interest in defining this calculator because we’re interested in dinucleotide motifs.</p>
</div>
<p>We then construct a seq-to-symbol convertor.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.stats.period</span> <span class="kn">import</span> <span class="n">SeqToSymbols</span>

<span class="n">seq_to_symbols</span> <span class="o">=</span> <span class="n">SeqToSymbols</span><span class="p">([</span><span class="s2">&quot;AA&quot;</span><span class="p">,</span> <span class="s2">&quot;TT&quot;</span><span class="p">,</span> <span class="s2">&quot;AT&quot;</span><span class="p">],</span> <span class="n">length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The rest is as per the analysis using <code class="docutils literal notranslate"><span class="pre">Goertzel</span></code> above.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cogent3.maths.stats.period</span> <span class="kn">import</span> <span class="n">blockwise_bootstrap</span>

<span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">blockwise_bootstrap</span><span class="p">(</span>
    <span class="n">s</span><span class="p">,</span>
    <span class="n">calc</span><span class="o">=</span><span class="n">hybrid_calculator</span><span class="p">,</span>
    <span class="n">block_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">num_reps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">seq_to_symbols</span><span class="o">=</span><span class="n">seq_to_symbols</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
<span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>104.35516278555667
</pre></div>
</div>
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, cogent3 Team.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>